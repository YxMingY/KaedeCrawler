package modules

import (
	"io"
	"log"
	"net/http"
	"time"
)

var tick = time.Tick(time.Millisecond * 100)

func Download(url string) string {
	resp, err := http.Get(url)
	if nil != err {
		log.Println(err)
		return ""
	}
	defer resp.Body.Close()
	content, err := io.ReadAll(resp.Body)
	if nil != err {
		log.Println(err)
		return ""
	}
	return string(content)
}

func AntiAntiCrawlerDownload(url string) string {
	<-tick
	req, err := http.NewRequest(http.MethodGet, url, nil)
	if nil != err {
		log.Println(err)
		return ""
	}
	req.Header.Add("User-Agent", "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Mobile Safari/537.36 Edg/114.0.1823.82")
	req.Header.Add("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9")
	//req.Header.Add("Accept-Encoding", "gzip, deflate, br")
	req.Header.Add("Accept-Language", "zh-CN,zh;q=0.9")
	req.Header.Add("Cookie", "BIDUPSID=626524610FD7539A57FBB1B2A93801B6; PSTM=1686454104; BAIDUID=626524610FD7539AA7B6AB4CF1E740AD:FG=1; BD_UPN=12314753; ispeed_lsm=2; MCITY=-289%3A231%3A; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; BDUSS=hqSktMSU9OOGdvQ3R-d0x1R1FQMTNrTDRufmJ6djB1b1lETlZHUzlaUVJnTjlrRVFBQUFBJCQAAAAAAAAAAAEAAADaW187WXhNaW5nWQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABHzt2QR87dkUT; BDUSS_BFESS=hqSktMSU9OOGdvQ3R-d0x1R1FQMTNrTDRufmJ6djB1b1lETlZHUzlaUVJnTjlrRVFBQUFBJCQAAAAAAAAAAAEAAADaW187WXhNaW5nWQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABHzt2QR87dkUT; BAIDUID_BFESS=626524610FD7539AA7B6AB4CF1E740AD:FG=1; RT=\"z=1&dm=baidu.com&si=0614f36b-da5e-4197-a910-015565d3045c&ss=lkaopt42&sl=2&tt=1so&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=ekc&ul=g5t&hd=g65\"; BD_HOME=1; BA_HECTOR=0l8k24048g250l25848l048c1ibi5gq1p; ZFY=oCXc:AVmy9Hrr8StkBYfcxF9xJgYaWnu:AHCJG9HxiOJ4:C; kleck=fda736ed1141c56862087a86f68f82a5; H_WISE_SIDS=234020_131861_216845_213349_214794_110085_243880_244729_256739_257586_260289_253022_261034_261715_236312_261868_259306_263073_256998_257289_256419_264205_256223_264319_261934_264853_265008_265030_265054_265141_265328_265299_265468_265648_265712_265851_261929_265881_265312_265997_261036_257015_265289_265277_259734_259730_259732_234207_234295_265802_264642_266355_266399_266639_266828_264768_266759_266743_267069_265886_267087_179348_257442_267101_266159_265776_266566_266965_253528_267344_267297_267375_267385_265825_267429_265615_267292_265564_267536_203518_265905_266188_264947_267868_267847_267787_267712_267899_267912_267928_267074_265635_260335_266420_259080_264353_265999_266714_265368_107315_268565_266451_266805_268637_268593; SE_LAUNCH=5%3A28164261; rsv_i=0fb1PF%2FVtpC7yUyE4G4VQMrKbo4qb2TURqrf20hVXZASgSXvOH6me5Qw4Goapb0C6H6FCQKYxboGsfaWINbViPy4g%2FavZ0I; delPer=0; BD_CK_SAM=1; PSINO=7; H_WISE_SIDS_BFESS=234020_131861_216845_213349_214794_110085_243880_244729_256739_257586_260289_253022_261034_261715_236312_261868_259306_263073_256998_257289_256419_264205_256223_264319_261934_264853_265008_265030_265054_265141_265328_265299_265468_265648_265712_265851_261929_265881_265312_265997_261036_257015_265289_265277_259734_259730_259732_234207_234295_265802_264642_266355_266399_266639_266828_264768_266759_266743_267069_265886_267087_179348_257442_267101_266159_265776_266566_266965_253528_267344_267297_267375_267385_265825_267429_265615_267292_265564_267536_203518_265905_266188_264947_267868_267847_267787_267712_267899_267912_267928_267074_265635_260335_266420_259080_264353_265999_266714_265368_107315_268565_266451_266805_268637_268593; baikeVisitId=4b9121e7-bb45-4b3f-b795-c1e84eb944d1; H_PS_PSSID=36556_38643_39026_39022_38943_38876_38984_39040_38828_38987_39085_26350_39051_39100_39043; ab_sr=1.0.1_MTFjMWRjYTU1ZTgwMDVkYTIwYjVmNjNiMmJlYTMwZTlkMjY4YzgzODJhZGNkZDZjYjAwZThkMmIwZmM4YTcyNjRjNzFmNDY0MDk3Mjk1YWYxY2FlZWYxZDI0MjQ0MjI5MjE2ZWU5ZTVmNWFiYmY5ZGM0ZWRkMTdmMDkyNzAxOGRlOWFhNjEzYmRmNTliMmJlMTdhZTdjZGMyYjIzY2FjOA==; Hm_lvt_aec699bb6442ba076c8981c6dc490771=1688968640,1689159538,1689477683,1689856037; Hm_lpvt_aec699bb6442ba076c8981c6dc490771=1689856037; BDRCVFR[feWj1Vr5u3D]=mk3SLVN4HKm; sugstore=0; H_PS_645EC=be99JPbkteAG5ipGswj5Sv5KbVDMu0cCu65uW71QGWBoQDY212A7d5o1QiFQtg9RkcL7")
	client := &http.Client{}
	resp, err := client.Do(req)
	if nil != err {
		log.Println(err)
		return ""
	}
	defer resp.Body.Close()
	body, err := io.ReadAll(resp.Body)
	if nil != err {
		log.Println(err)
		return ""
	}
	return string(body)
}
